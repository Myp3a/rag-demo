# Демо использования RAG для LLM
Небольшая демонстрация улучшения качества ответов на вопросы специфической сферы с использованием Retrieval-Augmented Generation.

# О системе
Это небольшой ассистент, обученный понимать термины и положения ГОСТ 27003-2021. Базовая модель - Mistral, дообучение LoRa - Сайга.  
Для исполнения модели используется `llama.cpp` как универсальный и легковесный вариант.

# Установка
Клонируйте репозиторий.  
Исполните `pip install -r requirements.txt`.  
Загрузите используемую модель [Saiga-Mistral](https://huggingface.co/IlyaGusev/saiga_mistral_7b_gguf) и отредактируйте путь к ней в файле `config.py`.  
Система готова к использованию!
> При первом запуске автоматически будет выполнены разбиение на чанки и векторизация представленного ГОСТ. Это может занять несколько минут.

# Запуск и использование
Исполните `python main.py`

# Примеры ответов
Без RAG система не способна выдать корректный ответ ввиду специфичности терминов и многовариантности аббревиатур. Вместе с RAG система может найти термины и их описания в представленном тексте и выдать релевантный ответ.
### Без RAG
```
Загружаю модель...
Модель загружена!

Привет! Я знаю все о ГОСТ 27003. Спроси меня о чем-нибудь!
Вопрос: Как дела?
Думаю...
Ответ:  Хорошо, благодарен за Ваше внимание.

Вопрос: Что такое СМИБ?
Думаю...
Ответ:  СМИБ является сокращением от "Система Мониторинга Информационных Билетов", которая предоставляет мониторинг информационных билетов для определения потребности в информационных ресурсах в организациях и предоставляет информацию о состоянии информационной безопасности.

Вопрос: Какие ее основные положения?
Думаю...
Ответ:  Основные положения СМИБ включают в себя

Вопрос: Что насчет пончиков?
Думаю...
Ответ:  Пончики - это традиционные российские печенье в форме шариков. Они обычно готовятся из муки, яиц, молока, сахара и масла или железного масла (растение). Пончики обычно подают в качестве десерта или закуски к кофе или чаю. Они также могут быть поданы в качестве предмета питания в кафе и ресторанах.
```

### Вместе с RAG
```
Загружаю модель...
Модель загружена!
Загружаю векторизацию ГОСТ...
ГОСТ загружен!

Привет! Я знаю все о ГОСТ 27003. Спроси меня о чем-нибудь!
Вопрос: Как дела?
Думаю...
Ответ:  Я могу помочь вам в любом вопросе.

Вопрос: Что такое СМИБ?
Думаю...
Ответ:  Система менеджмента информационной безопасности (СМИБ) - это структура, которая обеспечивает соответствие требованиям стандарта ISO/IEC 27001 "Методы и средства обеспечения безопасности информации. Системы менеджмента информационной безопасности. Общие требования". Эта система создается для обеспечения безопасности информации, которая используется в организации.

Вопрос: Какие ее основные положения?
Думаю...
Ответ:  Основные положения СМИБ включают в себя определение и оценку рисков информационной безопасности, управление рисками информационной безопасности, обработка рисков информационной безопасности и обязательства по защите информации. СМИБ также требует выполнения регулярной проверки эффективности системы менеджмента информационной безопасности и проведения обязательных инспекций.

Вопрос: Что насчет пончиков?
Думаю...
Ответ:  Пончик - это тип сладости из масляного теста в форме кольца или пятилепестки. Он часто подается на завтрак и обед и является популярным десертом в различных странах. Пончики могут быть разнообразными по вкусам и содержанию, включая различные сорта и начинки.
```

# Ограничения и заковырки
 - Формат ГОСТ не позволяет использовать запросы вроде "пятая глава", "сколько всего разделов" и похожие им ввиду отсутствия сопоставления "Глава N - название главы". Дополнительное форматирование документов поможет решить данную проблему.
 - Контекст истории переписки ограничен последними двумя сообщениями модели и двумя сообщениями пользователя. Это сделано ввиду ограничения контекста модели в 2048 токенов. Может быть решено с помощью динамического подытоживания текста и сокращения истории, но решается за рамками данного проекта.
 - Модель иногда игнорирует указание "не выдумывай". Наиболее вероятно из-за сложной структуры документа.
 - Выход реализован через `Ctrl+C`. Может быть легко заменено на команду, предпочтение автора.